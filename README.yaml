name: terraform-cron-based-api-trigger-lambda
gitlab_repo: miquido/terraform/terraform-cron-based-api-trigger-lambda
badges: []
related: []
description: |-
  You can define an endpoint and credentials for which a given request will be made with a cron schedule.

usage: |-
  ```hcl
    module "jazzed-mailchimp-sync-lambda" {
      source              = "git::ssh://git@gitlab.com/miquido/terraform/terraform-cron-based-api-trigger-lambda"
      name                = "mailchimp-sync"
      stage               = var.environment
      namespace           = var.aws_project_name
      tags                = var.default_tags

      schedule_expression = "cron(0 1 1/1 * ? *)"

      auth_hostname       = local.auth_domain
      auth_path           = "/auth/realms/jazzed/protocol/openid-connect/token"
      auth_method         = "POST"
      auth_content_type   = "application/x-www-form-urlencoded"
      auth_request        = "client_id=${var.mailchimp_client_id}&grant_type=client_credentials&client_secret=${var.mailchimp_client_secret}"

      api_hostname        = local.api_domain
      api_path            = "/api/graphql"
      api_method          = "POST"
      api_content_type    = "application/graphql"
      api_request         = "mutation test { mailchimp { synchronise } }"
    }
  ```

include:
  - "docs/targets.md"
  - "docs/terraform.md"
